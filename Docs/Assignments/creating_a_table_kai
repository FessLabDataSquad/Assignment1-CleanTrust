#How to create a table (Kai)
#This is a way to create a table of all the mismatched ID's. 
#It's quite messy, but it works. 
#Feel free to make it more clean/efficient. 

#Import files
raw1 = read.csv("RAW DATA game1_results FINAL.csv", header=TRUE, stringsAsFactors=FALSE)
raw2 = read.csv("RAW DATA game2_results FINAL.csv", header=TRUE, stringsAsFactors=FALSE)
raw3 = read.csv("RAW DATA game3_results FINAL.csv", header=TRUE, stringsAsFactors=FALSE)
raw4 = read.csv("RAW DATA game4_results FINAL.csv", header=TRUE, stringsAsFactors=FALSE)
raw5 = read.csv("RAW DATA game5_results FINAL.csv", header=TRUE, stringsAsFactors=FALSE)
raw6 = read.csv("RAW DATA Demographics_results FINAL.csv", header=TRUE, stringsAsFactors=FALSE)

#Load dplyr. Use anti_join function to compare two files. Order matters. 
library(dplyr)
compare1to5 = anti_join(raw1, raw5, by="dg1")
compare2to5 = anti_join(raw2, raw5, by="dg1")
compare3to5 = anti_join(raw3, raw5, by="dg1")
compare4to5 = anti_join(raw4, raw5, by="dg1")

compare5to1 = anti_join(raw5, raw1, by="dg1")
compare5to2 = anti_join(raw5, raw2, by="dg1")
compare5to3 = anti_join(raw5, raw3, by="dg1")
compare5to4 = anti_join(raw5, raw4, by="dg1")

#Select appropriate column (dg1) and create new column with name of comparison. 
compare1to5 = c(compare1to5$dg1, comparison = "1 to 5")
compare2to5 = c(compare2to5$dg1, comparison = "2 to 5")
compare3to5 = c(compare3to5$dg1, comparison = "3 to 5")
compare4to5 = c(compare4to5$dg1, comparison = "4 to 5")

compare5to1 = c(compare5to1$dg1, comparison = "5 to 1")
compare5to2 = c(compare5to2$dg1, comparison = "5 to 2")
compare5to3 = c(compare5to3$dg1, comparison = "5 to 3")
compare5to4 = c(compare5to4$dg1, comparison = "5 to 4")

#Transform into dataframe. 
compare1to5 = as.data.frame(compare1to5)
compare2to5 = as.data.frame(compare2to5)
compare3to5 = as.data.frame(compare3to5)
compare4to5 = as.data.frame(compare4to5)

compare5to1 = as.data.frame(compare5to1)
compare5to2 = as.data.frame(compare5to2)
compare5to3 = as.data.frame(compare5to3)
compare5to4 = as.data.frame(compare5to4)

#Switch the column into a row. 
compare1to5 = as.data.frame(t(compare1to5))
compare2to5 = as.data.frame(t(compare2to5))
compare3to5 = as.data.frame(t(compare3to5))
compare4to5 = as.data.frame(t(compare4to5))

compare5to1 = as.data.frame(t(compare5to1))
compare5to2 = as.data.frame(t(compare5to2))
compare5to3 = as.data.frame(t(compare5to3))
compare5to4 = as.data.frame(t(compare5to4))

# Give name to the comparison column. 
"comparison" -> colnames(compare1to5) [5] 
"comparison" -> colnames(compare2to5) [4]
"comparison" -> colnames(compare3to5) [4] 
"comparison" -> colnames(compare4to5) [4]

"comparison" -> colnames(compare5to1) [1] 
"comparison" -> colnames(compare5to2) [1]
"comparison" -> colnames(compare5to3) [1]
"comparison" -> colnames(compare5to4) [1]

#Load plyr. Merge two files at a time. 
library(plyr)
table = rbind.fill(compare1to5, compare2to5)
table = rbind.fill(table, compare3to5)
table = rbind.fill(table, compare4to5)
table = rbind.fill(table, compare5to1)
table = rbind.fill(table, compare5to2)
table = rbind.fill(table, compare5to3)
table = rbind.fill(table, compare5to4)

#table will give you this: 

V1   V2     V3     V4 comparison
1 1pepper1630 test        apple0     1 to 5
2 1pepper1630 test apple0   <NA>     2 to 5
3 1pepper1630 test apple0   <NA>     3 to 5
4 1pepper1630 test apple0   <NA>     4 to 5
5        <NA> <NA>   <NA>   <NA>     5 to 1
6        <NA> <NA>   <NA>   <NA>     5 to 2
7        <NA> <NA>   <NA>   <NA>     5 to 3
8        <NA> <NA>   <NA>   <NA>     5 to 4


